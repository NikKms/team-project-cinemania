function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},s=e.parcelRequire8a95;null==s&&((s=function(t){if(t in a)return a[t].exports;if(t in n){var e=n[t];delete n[t];var s={id:t,exports:{}};return a[t]=s,e.call(s.exports,s,s.exports),s.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){n[t]=e},e.parcelRequire8a95=s),s("g7hbw");var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a;return t};const r={pagination:document.getElementById("pagination"),catalogFilms:document.querySelector(".catalog-films"),searchForm:document.querySelector(".search-form"),selectGenres:document.querySelector("#selectGenres"),selectDate:document.querySelector("#selectDate")},o=t=>{const e=t.map((t=>`<li data-id=${t.id} class="catalog-card">\n      <img src='https://image.tmdb.org/t/p/original${t.poster}' alt="${t.title}" loading="lazy" />\n      <div class="catalog-info">\n      <p class="catalog-info-name">${t.title}</p>\n        <div class="catalog-info-container">\n          <p class="catalog-info-details">\n            <span>${t.genres}</span>\n            <span>${t.date}</span>\n          </p>\n          <div\n          class="Stars"\n          style="--rating: ${t.rating/2}"\n          aria-label="Rating of this product is 2.3 out of 5."\n        ></div>\n        </div>\n      </div>\n      <div class="overlay"></div>\n    </li>`)).join("");var a;a=e,r.catalogFilms.innerHTML=a};const l=async t=>{const e=await f(),a=t.map((({id:t,title:a,poster_path:n,vote_average:s,genre_ids:i,release_date:r})=>({id:t,title:a,poster:n,rating:s,genres:c(e,i),date:g(r)})));o(a)},c=(t,e)=>{const a=[];return t.map((({id:t,name:n})=>{-1!==e.indexOf(t)&&a.push(n)})),a.slice(0,2).join(", ")},g=t=>new Date(t).getFullYear(),d=(t,e)=>{try{const a=JSON.stringify(e);localStorage.setItem(t,a)}catch(t){console.error("Set state error: ",t.message)}},u=t=>{try{const e=localStorage.getItem(t);return null===e?void 0:JSON.parse(e)}catch(t){console.error("Get state error: ",t.message)}};class p{updatePage(t){this.currentPage=t,this.createButton()}constructor(e,a,n,s=[]){t(i)(this,"createButton",(async()=>{if(console.log(this.params),this.totalPages<=1)return void this.reset();this.arrPaginationItems=[],this.addFirstPages(this.arrPaginationItems),this.totalPages>6&&(this.addEllipsisIfNeeded(this.arrPaginationItems),this.addMiddlePages(this.arrPaginationItems),this.addEllipsisIfNeeded(this.arrPaginationItems,!0),this.addLastPage(this.arrPaginationItems));const t=this.createPagination(this.arrPaginationItems.join(""));this.render(t),d("currentPage",this.currentPage),console.log(...this.params),await this.getMovies(this.currentPage,...this.params),console.log(this.totalPages)})),t(i)(this,"addFirstPages",(t=>{for(let e=1;e<=Math.min(3,this.totalPages);e++){const a=this.currentPage===e?"btn-active":"",n=this.createPaginationItem("0"+e,a);t.push(n)}})),t(i)(this,"addMiddlePages",(t=>{const e=Math.max(4,this.currentPage-2),a=Math.min(this.currentPage+1,this.totalPages-1);for(let n=e;n<=a;n++){const e=this.currentPage===n?"btn-active":"";let a=[];a=n<=9?this.createPaginationItem("0"+n,e):this.createPaginationItem(n,e),t.push(a)}})),t(i)(this,"addEllipsisIfNeeded",((t,e=!1)=>{(e&&this.currentPage<this.totalPages-2||!e&&this.currentPage>3)&&t.push('<li class="pagination-item ellipsis">...</li>')})),t(i)(this,"addLastPage",(t=>{const e=this.totalPages,a=this.currentPage===e?"btn-active":"",n=this.createPaginationItem(e,a);t.push(n)})),t(i)(this,"createPaginationItem",((t,e)=>`<li class='pagination-item ${e}'>\n              <a href='#' data-page='${t}' class='pagination-btn'>${t}</a>\n            </li>`)),t(i)(this,"createPagination",(t=>`\n      <div class='pagination ${this.totalPages<=1?"pagination-hidden":""}'>\n      <button type="button" class='pagination-arrow pagination-arrows-prev${this.totalPages<=1?"pagination-arrows-hidden":""}'>prev</button>\n        <ul class='pagination-list'>${t}</ul>\n        <button type="button" class='pagination-arrow pagination-arrows-next${this.totalPages<=1?"pagination-arrows-hidden":""}'>next</button>\n      </div>`)),t(i)(this,"render",(t=>{this.reset(),r.catalogFilms.insertAdjacentHTML("afterend",t);const e=document.querySelector(".pagination"),a=document.querySelector(".pagination");e.addEventListener("click",this.handlerBtn),a.addEventListener("click",this.arrowHandler);const n=document.querySelector(".pagination-arrow.pagination-arrows-prev");1===this.currentPage?n.style.display="none":n.style.display="block";const s=document.querySelector(".pagination-arrow.pagination-arrows-next");this.currentPage===this.totalPages?s.style.display="none":s.style.display="block"})),t(i)(this,"arrowHandler",(t=>{const e=t.target;e.classList.contains("pagination-arrows-prev")&&this.prev(),e.classList.contains("pagination-arrows-next")&&this.next()})),t(i)(this,"reset",(()=>{const t=document.querySelector(".pagination");t&&t.remove()})),t(i)(this,"prev",(()=>{if(1===this.currentPage)return;this.currentPage-=1,this.createButton();const t=document.querySelector(".pagination-arrow.pagination-arrows-prev");1===this.currentPage?t.style.display="none":t.style.display="block"})),t(i)(this,"next",(()=>{if(this.currentPage===this.totalPages)return;this.currentPage+=1,this.createButton();const t=document.querySelector(".pagination-arrow.pagination-arrows-next");this.currentPage===this.totalPages?t.style.display="none":t.style.display="block"})),t(i)(this,"handlerBtn",(t=>{t.preventDefault();const e=parseInt(t.target.dataset.page);isNaN(e)||(this.currentPage=e,this.createButton())})),console.log(s),this.totalPages=e,this.currentPage=a,this.getMovies=n,this.params=s,this.arrPaginationItems=[]}}var h=s("19F3f"),m=s("2shzp"),v=s("kHmXk");const y=async(t,e=1,a="")=>{r.selectGenres.disabled=!0,r.selectDate.disabled=!1,console.log(t,e,a);const{results:n,total_pages:s,page:i}=await(0,h.getByQuery)(t,e,a);return l(n),{results:n,total_pages:s,page:i}},P=async(t,e=0)=>{r.selectGenres.disabled=!1,r.selectDate.disabled=!0;const{data:a}=await async function(t){try{(0,v.onLoader)();const e=await m.default.get(t);return(0,v.removeLoader)(),e}catch(t){return console.log(t),(0,v.removeLoader)(),null}}(`https://api.themoviedb.org/3/movie/now_playing?api_key=88b8a7c5d221d3120fb29d734050dc7d&page=${t}${e?`&with_genres=${e}`:""}&language=en-US`);console.log(a);const{results:n,page:s,total_pages:i}=a;return console.log(n),l(n),{results:n,page:s,total_pages:i}},f=async()=>{const{data:t}=await m.default.get("https://api.themoviedb.org/3/genre/movie/list?api_key=88b8a7c5d221d3120fb29d734050dc7d"),{genres:e}=t;return e},w=document.querySelector(".search-form"),b=document.querySelector("#selectGenres"),S=document.querySelector("#selectDate"),_=async()=>{const{page:t,total_pages:e}=await P(1);new p(e,t,P).createButton()},$=async t=>{const e=u("searchTerm");console.log("afterSearching",e);const{page:a,total_pages:n}=await y(e,1);new p(n,a,y,[e,a]).createButton(),S.removeAttribute("disabled")};w.addEventListener("submit",(t=>{t.preventDefault();const e=new FormData(t.target),{searchMovies:a}=Object.fromEntries(e.entries());a.length?(d("searchTerm",a),$(a)):_()})),window.addEventListener("load",_),window.addEventListener("load",(async()=>{let t=(await f()).map((t=>`<option value="${t.id}">${t.name}</option>`));t.unshift("<option value='all'>All</option>"),b.innerHTML=t.join(""),b.removeAttribute("disabled")})),window.addEventListener("load",(()=>{const t=[];for(let e=(new Date).getFullYear();e>=1970;e--)t.push(`<option value="${e}">${e}</option>`);S.innerHTML=t.join("")})),b.addEventListener("change",(async t=>{const e=t.target.value,{total_pages:a,results:n}=await P(1,t.target.value);new p(a,1,P,[e]).createButton()})),S.addEventListener("change",(async t=>{const e=t.target.value,a=u("searchTerm"),{total_pages:n,page:s}=await y(a,1,e);new p(n,1,y,[a,1,e]).createButton()})),s("7Yg6P"),s("2tESM");
//# sourceMappingURL=catalog.8d498beb.js.map
